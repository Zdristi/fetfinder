{% extends "base.html" %}

{% block title %}{{ get_text('signup') }} - {{ SITE_NAME }}{% endblock %}

{% block head %}
    {{ super() }}
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
{% endblock %}

{% block content %}
<div class="card" style="max-width: 500px; margin: 50px auto;">
    <div class="card-header">
        <h2 class="card-title">{{ get_text('signup') }}</h2>
    </div>
    
    <!-- Flash messages -->
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <div id="flash-messages" style="margin: 0 20px 20px 20px; padding: 10px; border-radius: 5px; background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;">
                {% for message in messages %}
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div><i class="fas fa-exclamation-triangle"></i> {{ message }}</div>
                        <button type="button" onclick="this.parentElement.parentElement.style.display='none';" style="background: none; border: none; color: #721c24; font-size: 1.2em; cursor: pointer;">&times;</button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}
    
    <form method="POST">
        <div class="form-group">
            <label for="username" class="form-label">{{ get_text('username') }} *</label>
            <input type="text" id="username" name="username" required class="form-control" placeholder="{{ get_text('username') }}">
        </div>
        
        <div class="form-group">
            <label for="email" class="form-label">{{ get_text('email') }} *</label>
            <input type="email" id="email" name="email" required class="form-control" placeholder="{{ get_text('email') }}">
        </div>
        
        <div class="form-group">
            <label for="password" class="form-label">{{ get_text('password') }} *</label>
            <input type="password" id="password" name="password" required class="form-control" placeholder="{{ get_text('password') }}">
        </div>
        
        <!-- reCAPTCHA widget -->
        <div class="form-group">
            <div class="g-recaptcha" data-sitekey="6Lc6BhgUAAAAAAH5u7f8rXz8rXz8rXz8rXz8rXz8"></div>
        </div>
        
        <button type="submit" class="btn" style="width: 100%; padding: 15px; font-size: 1.1rem;">
            <i class="fas fa-user-plus"></i> {{ get_text('signup') }}
        </button>
    </form>
    
    <div style="text-align: center; margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee;">
        <p style="color: var(--gray);">
            {{ get_text('already_have_account') }} <a href="{{ url_for('login') }}">{{ get_text('login') }}</a>
        </p>
    </div>
</div>

<script>
// Auto-hide flash messages after 5 seconds
setTimeout(function() {
    const flashContainer = document.getElementById('flash-messages');
    if (flashContainer) {
        flashContainer.style.display = 'none';
    }
}, 5000);
</script>
{% endblock %}